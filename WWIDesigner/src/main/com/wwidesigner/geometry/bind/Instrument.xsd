<?xml version="1.0" encoding="UTF-8"?>
<xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
	xmlns:wii="http://www.wwidesigner.com/Instrument" targetNamespace="http://www.wwidesigner.com/Instrument"
	elementFormDefault="unqualified">

	<xsd:element name="instrument" type="wii:Instrument" />

	<xsd:complexType name="Instrument">
		<xsd:annotation>
			<xsd:documentation>The physical geometry of a wood wind. Dimensions
				may represent initial values subject to optimization or final values
				fixed throughout the calculations.
			</xsd:documentation>
		</xsd:annotation>
		<xsd:sequence>
			<xsd:element name="name" type="xsd:string" />
			<xsd:element name="description" type="xsd:string"
				minOccurs="0" />
			<xsd:element name="lengthType" type="wii:LengthType">
				<xsd:annotation>
					<xsd:documentation>Units of measurement, applied to all dimensions.
					</xsd:documentation>
				</xsd:annotation>
			</xsd:element>
			<xsd:element name="mouthpiece" type="wii:Mouthpiece"
				minOccurs="0">
				<xsd:annotation>
					<xsd:documentation>Description of the "drive" end.
					</xsd:documentation>
				</xsd:annotation>
			</xsd:element>
			<xsd:element name="mouthpieceOrigin" type="wii:BorePoint">
				<xsd:annotation>
					<xsd:documentation>BorePoint that defines the flute origin. Center
						of embouchure hole, top of fipple window, etc.
					</xsd:documentation>
				</xsd:annotation>
			</xsd:element>
			<xsd:element name="borePoint" type="wii:BorePoint"
				maxOccurs="unbounded">
				<xsd:annotation>
					<xsd:documentation>Sequence of inside diameter measurements for
						non-uniform bore, from fipple, cork or other head-end termination,
						to bottom-end. Assume segments between bore points
						are conical, with linear increase in diameter.
					</xsd:documentation>
				</xsd:annotation>
			</xsd:element>
			<xsd:element name="hole" type="wii:Hole" minOccurs="0"
				maxOccurs="unbounded">
				<xsd:annotation>
					<xsd:documentation>Hole specifications for toneholes,
						from mouthpiece to bottom-end.
					</xsd:documentation>
				</xsd:annotation>
			</xsd:element>
			<xsd:element name="termination" type="wii:Termination">
				<xsd:annotation>
					<xsd:documentation>Description of bottom end. The position and bore
						diameter of the termination is specified by the borePoint with the
						greatest position.
					</xsd:documentation>
				</xsd:annotation>
			</xsd:element>
		</xsd:sequence>
	</xsd:complexType>

	<xsd:simpleType name="LengthType">
		<xsd:annotation>
			<xsd:documentation>An enumeration, applied globally to all
				Dimensions, indicating mm or inch values.
			</xsd:documentation>
		</xsd:annotation>
		<xsd:restriction base="xsd:token">
			<xsd:enumeration value="mm" />
			<xsd:enumeration value="in" />
		</xsd:restriction>
	</xsd:simpleType>

	<xsd:simpleType name="Optimization">
		<xsd:annotation>
			<xsd:documentation>An enumeration, applied individually to all
				Dimension values, that is interpreted by the optimization engine. We
				might want to add other/additional values to this enumeration.
			</xsd:documentation>
		</xsd:annotation>
		<xsd:restriction base="xsd:token">
			<xsd:enumeration value="FIXED" />
			<xsd:enumeration value="FREE" />
		</xsd:restriction>
	</xsd:simpleType>

	<xsd:complexType name="Dimension">
		<xsd:annotation>
			<xsd:documentation>Base class for a double value and associated
				optimization flag.
			</xsd:documentation>
		</xsd:annotation>
		<xsd:sequence>
			<xsd:element name="value" type="xsd:double" />
			<xsd:element name="optimization" type="wii:Optimization" />
		</xsd:sequence>
	</xsd:complexType>

	<xsd:complexType name="ZeroOrMore">
		<xsd:annotation>
			<xsd:documentation>A non-negative Dimension.</xsd:documentation>
		</xsd:annotation>
		<xsd:complexContent>
			<xsd:restriction base="wii:Dimension">
				<xsd:sequence>
					<xsd:element name="value">
						<xsd:simpleType>
							<xsd:restriction base="xsd:double">
								<xsd:minInclusive value="0" />
							</xsd:restriction>
						</xsd:simpleType>
					</xsd:element>
					<xsd:element name="optimization" type="wii:Optimization" />
				</xsd:sequence>
			</xsd:restriction>
		</xsd:complexContent>
	</xsd:complexType>

	<xsd:complexType name="MoreThanZero">
		<xsd:annotation>
			<xsd:documentation>A Dimension with a value greater than 0.
			</xsd:documentation>
		</xsd:annotation>
		<xsd:complexContent>
			<xsd:restriction base="wii:Dimension">
				<xsd:sequence>
					<xsd:element name="value">
						<xsd:simpleType>
							<xsd:restriction base="xsd:double">
								<xsd:minExclusive value="0" />
							</xsd:restriction>
						</xsd:simpleType>
					</xsd:element>
					<xsd:element name="optimization" type="wii:Optimization" />
				</xsd:sequence>
			</xsd:restriction>
		</xsd:complexContent>
	</xsd:complexType>

	<xsd:complexType name="BorePoint">
		<xsd:annotation>
			<xsd:documentation>Represents a bore position and effective diameter,
				measured from an arbitrary position, greater positions toward the
				foot of the instrument. Diameters between
				borePoints are linearly interpolated.
			</xsd:documentation>
		</xsd:annotation>
		<xsd:sequence>
			<xsd:element name="borePosition" type="wii:Dimension" />
			<xsd:element name="boreDiameter" type="wii:ZeroOrMore" />
		</xsd:sequence>
	</xsd:complexType>

	<xsd:complexType name="Key">
		<xsd:annotation>
			<xsd:documentation>Representation of a key mechanism over a tone
				hole.
			</xsd:documentation>
		</xsd:annotation>
		<xsd:sequence>
			<xsd:element name="diameter" type="wii:MoreThanZero" />
			<xsd:element name="holeDiameter" type="wii:ZeroOrMore" />
			<xsd:element name="height" type="wii:ZeroOrMore" />
			<xsd:element name="thickness" type="wii:ZeroOrMore" />
			<xsd:element name="wallThickness" type="wii:ZeroOrMore" />
			<xsd:element name="chimneyHeight" type="wii:ZeroOrMore" />
		</xsd:sequence>
	</xsd:complexType>

	<xsd:complexType name="Hole">
		<xsd:annotation>
			<xsd:documentation>A tone hole with optional key mechanism. The tone
				hole assumes a cylindrical shape with a radiused inner edge. More
				complexity is possible, including truncated conical profiles and
				angled holes.
			</xsd:documentation>
		</xsd:annotation>
		<xsd:sequence>
			<xsd:element name="name" type="xsd:string" minOccurs="0" />
			<xsd:element name="position" type="wii:ZeroOrMore">
				<xsd:annotation>
					<xsd:documentation>Position of hole, relative to reference
						position, measured from mouthpiece to bottom end.
					</xsd:documentation>
				</xsd:annotation>
			</xsd:element>
			<xsd:element name="diameter" type="wii:MoreThanZero" />
			<xsd:element name="height" type="wii:MoreThanZero" />
			<xsd:element name="innerCurvatureRadius" type="wii:ZeroOrMore"
				minOccurs="0" />
			<xsd:element name="key" type="wii:Key" minOccurs="0" />
		</xsd:sequence>
	</xsd:complexType>

	<xsd:complexType name="Mouthpiece">
		<xsd:annotation>
			<xsd:documentation>First pass at a sound-mechanism model. Represents
				a choice between (1) a characteristic length, (2) a flute-type
				embouchure, and (3) a fipple mechanism. We need to add reeds,
				end-blown flutes, etc. The position of the mouthpiece is taken from
				the mouthpieceOrigin borePoint.
			</xsd:documentation>
		</xsd:annotation>
		<xsd:sequence>
			<xsd:choice>
				<xsd:element name="characteristicLength" type="wii:MoreThanZero" />
				<xsd:element name="embouchureHole">
					<xsd:complexType>
						<xsd:sequence>
							<xsd:element name="innerDiameter" type="wii:MoreThanZero">
								<xsd:annotation>
									<xsd:documentation>Equivalent diameter of hole inside the tube.
									</xsd:documentation>
								</xsd:annotation>
							</xsd:element>
							<xsd:element name="outerDiameter" type="wii:MoreThanZero">
								<xsd:annotation>
									<xsd:documentation>Equivalent diameter of hole outside the
										tube.
									</xsd:documentation>
								</xsd:annotation>
							</xsd:element>
							<xsd:element name="height" type="wii:MoreThanZero">
								<xsd:annotation>
									<xsd:documentation>Chimney height of hole, from inside to
										outsides.
									</xsd:documentation>
								</xsd:annotation>
							</xsd:element>
							<xsd:element name="headPoint" type="wii:BorePoint"
								maxOccurs="unbounded">
								<xsd:annotation>
									<xsd:documentation>BorePoints that define the bore profile
										above the embouchure hole center. Each position is relative to
										the mouthpieceOrigin position, decreasing as you move up the
										flute. Because the origin is in the center of the embouchure
										hole, there must be at least one headPoint.
									</xsd:documentation>
								</xsd:annotation>
							</xsd:element>
						</xsd:sequence>
					</xsd:complexType>
				</xsd:element>
				<xsd:element name="fipple">
					<xsd:complexType>
						<xsd:sequence>
							<xsd:element name="windowLength" type="wii:MoreThanZero">
								<xsd:annotation>
									<xsd:documentation>Distance from fipple to sound blade.
									</xsd:documentation>
								</xsd:annotation>
							</xsd:element>
							<xsd:element name="windowWidth" type="wii:MoreThanZero">
								<xsd:annotation>
									<xsd:documentation>Side-to-side width of window.
									</xsd:documentation>
								</xsd:annotation>
							</xsd:element>
							<xsd:element name="fippleFactor" type="wii:MoreThanZero" minOccurs="0">
								<xsd:annotation>
									<xsd:documentation>An empirical multiplier of the calculated
										characteristic dimension of the window.
										The impedance model does not use this value.
									</xsd:documentation>
								</xsd:annotation>
							</xsd:element>
							<xsd:element name="windowHeight" type="wii:MoreThanZero">
								<xsd:annotation>
									<xsd:documentation>Average "height" of window, between inside
										and outside of tube.
									</xsd:documentation>
								</xsd:annotation>
							</xsd:element>
							<xsd:element name="windwayLength" type="wii:MoreThanZero"
								minOccurs="0">
								<xsd:annotation>
									<xsd:documentation>Length of windway, from beak to exit.
									</xsd:documentation>
								</xsd:annotation>
							</xsd:element>
							<xsd:element name="windwayHeight" type="wii:MoreThanZero">
								<xsd:annotation>
									<xsd:documentation>Average height of windway at the exit.
									</xsd:documentation>
								</xsd:annotation>
							</xsd:element>
						</xsd:sequence>
					</xsd:complexType>
				</xsd:element>
			</xsd:choice>
			<xsd:element name="beta">
				<xsd:annotation>
					<xsd:documentation>Jet spatial amplification factor
						typically between 0.3 and 0.4.
						See Auvray, et al., "Regime change and oscillation
						thresholds in recorder-like instruments",
						J. Acoust. Soc. Am. 131 (2), February 2012
					</xsd:documentation>
				</xsd:annotation>
				<xsd:simpleType>
					<xsd:restriction base="xsd:double">
						<xsd:minExclusive value="0"></xsd:minExclusive>
					</xsd:restriction>
				</xsd:simpleType>
			</xsd:element>
		</xsd:sequence>
	</xsd:complexType>

	<xsd:complexType name="Termination">
		<xsd:annotation>
			<xsd:documentation>Description of the opening at the bottom end of
				the instrument.
			</xsd:documentation>
		</xsd:annotation>
		<xsd:sequence>
			<xsd:element name="flangeDiameter" type="wii:ZeroOrMore">
				<xsd:annotation>
					<xsd:documentation>Outer diameter of the open end.
						Zero if the bottom end is closed.
					</xsd:documentation>
				</xsd:annotation>
			</xsd:element>
		</xsd:sequence>
	</xsd:complexType>

</xsd:schema>